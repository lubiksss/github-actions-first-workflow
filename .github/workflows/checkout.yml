name: Our Workflow
on:
  push:
    tags:
      - 'v*.*.*'
      - '!v*.*.*-*'
jobs:
  win-build:
    runs-on: windows-latest
    steps:
      - run: exit 1

  win-noti-success:
    if: ${{ always() && contains(needs.win-build.result, 'success') }}
    needs: win-build
    runs-on: ubuntu-latest
    steps:
      - name: Build Success
        uses: appleboy/telegram-action@master
        with:
          to: ${{ secrets.TELEGRAM_TO }}
          token: ${{ secrets.TELEGRAM_TOKEN }}
          message: |
            Author: ${{github.actor}}
            Status: ðŸ˜š **Success**
            Platform: Windows
            [See changes](https://github.com/${{ github.repository }}/commit/${{github.sha}})

  win-noti-fail:
    if: ${{ always() && contains(needs.win-build.result, 'fail') }}
    needs: win-build
    runs-on: ubuntu-latest
    steps:
      - name: Build Failure
        uses: appleboy/telegram-action@master
        with:
          to: ${{ secrets.TELEGRAM_TO }}
          token: ${{ secrets.TELEGRAM_TOKEN }}
          message: |
            Author: ${{github.actor}}
            Status: ðŸ˜± **Failure**
            Platform: Windows
            [link](https://github.com/${{ github.repository }}/actions)

  mac-build:
    runs-on: macos-latest
    steps:
      - run: exit 1

  mac-noti-success:
    if: ${{ always() && contains(needs.mac-build.result, 'success') }}
    needs: mac-build
    runs-on: ubuntu-latest
    steps:
      - name: Build Success
        uses: appleboy/telegram-action@master
        with:
          to: ${{ secrets.TELEGRAM_TO }}
          token: ${{ secrets.TELEGRAM_TOKEN }}
          message: |
            Author: ${{github.actor}}
            Status: ðŸ˜š **Success**
            Platform: Mac
            [See changes](https://github.com/${{ github.repository }}/commit/${{github.sha}})

  mac-noti-fail:
    if: ${{ always() && contains(needs.mac-build.result, 'fail') }}
    needs: mac-build
    runs-on: ubuntu-latest
    steps:
      - name: Build Failure
        uses: appleboy/telegram-action@master
        with:
          to: ${{ secrets.TELEGRAM_TO }}
          token: ${{ secrets.TELEGRAM_TOKEN }}
          message: |
            Author: ${{github.actor}}
            Status: ðŸ˜± **Failure**
            Platform: Mac
            [link](https://github.com/${{ github.repository }}/actions)
